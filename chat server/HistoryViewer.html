
<script>


function processMessages(){
    messageDiv = document.getElementById("messages")
    messageDiv.innerHTML = ""
    var index = 0;
    messages =  JSON.parse(this.responseText);
    for (index = 0;index < messages.length; index++){
        date = new Date(messages[index]["time"]*1000)
        messageDiv.innerHTML += date.toLocaleString()+":<b>"+messages[index]["username"]+"</b>:"+messages[index]["message"]+"<br>";
    }

}

function fetchMessages(){
    request = new XMLHttpRequest();
    request.addEventListener("load",processMessages)
    request.open("GET","/messages")
    request.send()
}

setInterval(fetchMessages,1000)

</script>

<body>
<div id="messages"></div>
</body>
